# 卫星信号可见性计算软件 - 开发计划

## 文档信息
- **文件名称**：开发计划.md
- **创建日期**：2025-01-09
- **最后更新**：2025-01-09
- **文件用途**：项目开发计划和进度跟踪

## 项目概述

### 项目基本信息
- **项目名称**：卫星信号可见性计算软件
- **项目版本**：v1.0.0
- **开发周期**：12周
- **当前阶段**：核心算法开发（TDD模式）
- **总体进度**：13% (1/8 项主要任务完成)

### 项目目标
- 实时计算飞机飞行过程中北斗和GPS卫星信号可见性
- 支持北斗B3I频点（1268.52MHz）和GPS L1 C/A频点（1575.42MHz）
- 更新频率100ms，端到端响应时间100ms
- 采用TDD开发模式，确保代码质量和测试覆盖率

### 技术栈
- **后端**：Node.js + Express
- **前端**：React + Three.js
- **数据库**：MongoDB
- **测试框架**：Jest
- **实时通信**：WebSocket

## 开发阶段划分

### 第一阶段：环境搭建和项目结构（第1周）

#### 1.1 项目目录结构
```
fly_cline/
├── src/
│   ├── algorithms/
│   │   ├── satellite/
│   │   │   ├── orbitalCalculator.js
│   │   │   ├── coordinateConverter.js
│   │   │   └── timeConverter.js
│   │   ├── geometry/
│   │   │   ├── intersectionCalculator.js
│   │   │   └── spatialPartitioning.js
│   │   ├── signal/
│   │   │   ├── propagationCalculator.js
│   │   │   ├── antennaGainCalculator.js
│   │   │   └── cn0Calculator.js
│   │   └── data/
│   │       ├── rinexParser.js
│   │       ├── aircraftModel.js
│   │       └── trajectoryGenerator.js
│   ├── models/
│   │   ├── satellite.js
│   │   ├── aircraft.js
│   │   └── antenna.js
│   ├── utils/
│   │   ├── mathUtils.js
│   │   ├── validationUtils.js
│   │   └── constants.js
│   └── config/
│       ├── system.config.js
│       ├── algorithm.config.js
│       └── satellite.config.js
├── tests/
│   ├── unit/
│   │   ├── algorithms/
│   │   │   ├── satellite/
│   │   │   ├── geometry/
│   │   │   ├── signal/
│   │   │   └── data/
│   │   ├── models/
│   │   └── utils/
│   ├── integration/
│   ├── e2e/
│   └── performance/
├── test-data/
│   ├── rinex/
│   ├── satellite-positions/
│   ├── coordinate-conversion/
│   └── aircraft-trajectories/
├── docs/
├── config/
├── jest.config.js
├── package.json
└── .gitignore
```

#### 1.2 测试环境搭建
**任务清单**：
- [ ] 安装必要的npm包（Jest, @types/jest, eslint, prettier, husky, lint-staged）
- [ ] 配置Jest测试环境（测试覆盖率要求95%）
- [ ] 配置ESLint和Prettier代码规范
- [ ] 设置husky git hooks和lint-staged
- [ ] 创建package.json配置文件
- [ ] 创建jest.config.js配置文件
- [ ] 创建.eslintrc.js配置文件
- [ ] 创建.prettierrc配置文件

**技术要求**：
- 单元测试覆盖率 ≥ 95%
- 分支覆盖率 ≥ 95%
- 语句覆盖率 ≥ 95%
- 代码检查通过ESLint
- 代码格式符合Prettier标准

#### 1.3 项目配置文件创建
**任务清单**：
- [ ] 创建package.json（项目依赖、脚本命令）
- [ ] 创建jest.config.js（测试配置）
- [ ] 创建.eslintrc.js（代码检查配置）
- [ ] 创建.prettierrc（代码格式化配置）
- [ ] 创建.gitignore（Git忽略文件）
- [ ] 创建README.md（项目说明文档）

### 第二阶段：卫星位置计算算法开发（第2周）

#### 2.1 算法模块划分
**1. 开普勒轨道计算模块**
- **功能**：根据卫星轨道参数计算卫星位置
- **输入**：轨道六根数、时间参数
- **输出**：卫星在ECEF坐标系中的位置
- **关键算法**：
  - 平近点角计算
  - 偏近点角计算（牛顿迭代法）
  - 真近点角计算
  - 卫星位置计算

**2. 坐标转换模块**
- **功能**：不同坐标系之间的转换
- **输入**：源坐标系坐标、转换参数
- **输出**：目标坐标系坐标
- **关键算法**：
  - LLA到ECEF转换
  - ECEF到LLA转换
  - 机体坐标系到ECEF转换
  - ECEF到机体坐标系转换

**3. 时间系统转换模块**
- **功能**：不同时间系统之间的转换
- **输入**：源时间系统时间、转换参数
- **输出**：目标时间系统时间
- **关键算法**：
  - GPS时间到UTC时间转换
  - UTC时间到GPS时间转换
  - 儒略日计算
  - 周秒计算

#### 2.2 TDD开发流程
**任务清单**：
- [ ] 编写卫星位置计算测试用例
- [ ] 实现开普勒轨道计算算法
- [ ] 编写坐标转换测试用例
- [ ] 实现坐标转换算法
- [ ] 编写时间转换测试用例
- [ ] 实现时间转换算法
- [ ] 运行单元测试确保通过
- [ ] 检查代码覆盖率
- [ ] 性能测试和优化

**测试要求**：
- 正常情况测试覆盖
- 边界条件测试覆盖
- 异常情况测试覆盖
- 精度验证测试覆盖
- 测试覆盖率 ≥ 95%

#### 2.3 数据类型使用规范
**使用double型的情况**：
- 卫星位置坐标（x, y, z）
- 轨道参数（半长轴、偏心率、倾角等）
- 角度计算（平近点角、偏近点角、真近点角）
- 时间计算（儒略日、GPS时间、UTC时间）
- 距离计算（卫星到接收机距离）

**使用整型的情况**：
- 卫星ID（B01-B30、G01-G32）
- 迭代计数器、数组索引
- 最大迭代次数、数据版本号
- 状态码、错误码

**使用布尔型的情况**：
- 计算收敛状态
- 数据有效性标志
- 配置开关

#### 2.4 测试数据准备
**任务清单**：
- [ ] 准备标准RINEX文件（北斗、GPS）
- [ ] 准备已知卫星位置的基准测试数据
- [ ] 准备坐标转换的基准测试数据
- [ ] 准备时间转换的基准测试数据
- [ ] 准备边界条件和异常情况测试数据

### 第三阶段：坐标转换算法开发（第2周）

#### 3.1 算法实现
**1. LLA↔ECEF转换算法**
- **功能**：大地坐标系与地心地固坐标系之间的转换
- **输入**：LLA坐标（经度、纬度、高度）
- **输出**：ECEF坐标（x, y, z）
- **技术要点**：
  - 使用WGS84椭球模型
  - 实现高精度转换算法
  - 考虑椭球扁率影响

**2. 机体坐标系↔ECEF转换算法**
- **功能**：飞机机体坐标系与地心地固坐标系之间的转换
- **输入**：机体坐标、飞机位置、姿态参数
- **输出**：ECEF坐标
- **技术要点**：
  - 欧拉角转换
  - 坐标旋转矩阵
  - 考虑飞机姿态影响

#### 3.2 TDD开发流程
**任务清单**：
- [ ] 编写LLA↔ECEF转换测试用例
- [ ] 实现LLA↔ECEF转换算法
- [ ] 编写机体坐标系↔ECEF转换测试用例
- [ ] 实现机体坐标系↔ECEF转换算法
- [ ] 运行单元测试确保通过
- [ ] 检查代码覆盖率
- [ ] 精度验证和优化

#### 3.3 数据类型使用规范
**使用double型的情况**：
- LLA坐标（经度、纬度、高度）
- ECEF坐标（x, y, z）
- 机体坐标（x, y, z）
- 姿态角度（俯仰、横滚、偏航）
- 转换矩阵元素

**使用整型的情况**：
- 坐标系类型枚举
- 精度级别
- 转换步骤计数

### 第四阶段：RINEX数据解析算法开发（第2周）

#### 4.1 算法实现
**1. RINEX 2.x格式解析**
- **功能**：解析RINEX 2.x格式文件
- **输入**：RINEX文件路径
- **输出**：卫星轨道数据、观测数据
- **技术要点**：
  - 文件头解析
  - 观测数据解析
  - 导航数据解析
  - 错误处理和数据验证

**2. RINEX 3.x格式解析**
- **功能**：解析RINEX 3.x格式文件
- **输入**：RINEX文件路径
- **输出**：卫星轨道数据、观测数据
- **技术要点**：
  - 新格式特性支持
  - 向后兼容RINEX 2.x
  - 多系统支持（北斗、GPS）

#### 4.2 TDD开发流程
**任务清单**：
- [ ] 编写RINEX 2.x解析测试用例
- [ ] 实现RINEX 2.x解析算法
- [ ] 编写RINEX 3.x解析测试用例
- [ ] 实现RINEX 3.x解析算法
- [ ] 运行单元测试确保通过
- [ ] 检查代码覆盖率
- [ ] 格式兼容性测试

#### 4.3 数据类型使用规范
**使用整型的情况**：
- RINEX版本号（2、3）
- 卫星数量
- 行号、记录号
- 数据类型标识符

**使用字符串的情况**：
- 卫星系统标识（'G'、'B'）
- 文件路径
- 时间字符串
- 记录类型标识

**使用布尔型的情况**：
- 文件头行判断
- 数据行判断
- 记录有效性标志

### 第五阶段：算法集成测试（第2周末）

#### 5.1 集成测试
**任务清单**：
- [ ] 端到端测试（RINEX解析→卫星位置计算）
- [ ] 坐标转换链测试
- [ ] 时间转换链测试
- [ ] 性能测试（大数据量处理）
- [ ] 内存使用测试
- [ ] 并发处理测试

**测试要求**：
- 端到端功能正常
- 性能满足要求（单次计算<10ms）
- 内存使用<100MB
- 支持100个并发请求

#### 5.2 文档完善
**任务清单**：
- [ ] API文档编写
- [ ] 函数说明文档
- [ ] 参数说明文档
- [ ] 返回值说明文档
- [ ] 使用示例文档
- [ ] 测试用例文档

## 时间安排和里程碑

### 第1周里程碑
- **完成时间**：2025-01-17
- **交付物**：
  - 完整的项目目录结构
  - 测试环境搭建完成
  - 项目配置文件创建完成
  - 开发环境就绪

### 第2周里程碑
- **完成时间**：2025-01-24
- **交付物**：
  - 卫星位置计算算法完成
  - 坐标转换算法完成
  - RINEX数据解析算法完成
  - 算法集成测试通过
  - 单元测试覆盖率≥95%

### 第3-4周里程碑
- **完成时间**：2025-02-07
- **交付物**：
  - 遮挡计算算法完成
  - 信号处理算法完成
  - 飞机数据管理模块完成
  - 核心算法集成测试通过

### 第5-7周里程碑
- **完成时间**：2025-02-28
- **交付物**：
  - 后端服务开发完成
  - API接口完成
  - WebSocket实时通信完成
  - 后端集成测试通过

### 第8-9周里程碑
- **完成时间**：2025-03-14
- **交付物**：
  - 前端界面开发完成
  - 3D可视化功能完成
  - 用户交互功能完成
  - 前后端集成测试通过

### 第10周里程碑
- **完成时间**：2025-03-21
- **交付物**：
  - 系统集成测试完成
  - 性能优化完成
  - 系统稳定性测试通过

### 第11周里程碑
- **完成时间**：2025-03-28
- **交付物**：
  - 文档完善完成
  - 用户手册完成
  - 部署文档完成

### 第12周里程碑
- **完成时间**：2025-04-04
- **交付物**：
  - 用户验收测试完成
  - 项目正式交付
  - 维护计划制定

## 技术要求和标准

### 1. 数据类型使用策略
**精度优先（使用double型）**：
- 卫星位置计算（经度、纬度、高度、轨道参数）
- 坐标转换（ECEF坐标、LLA坐标转换过程）
- 时间计算（儒略日、GPS时间、UTC时间转换）
- 角度计算（三角函数运算、角度转换）
- 距离计算（卫星到接收机距离、几何距离）
- 信号处理（载噪比、信号强度、传播损耗）

**性能优先（使用整型）**：
- 卫星ID（B01-B30、G01-G32等标识符）
- 迭代计数（循环计数器、数组索引）
- 状态码（错误码、状态标志）
- 数据版本（RINEX版本号、数据格式版本）
- 配置参数（最大迭代次数、数组大小等固定值）

**状态判断（使用布尔型）**：
- 计算成功/失败状态
- 数据有效/无效标志
- 功能启用/禁用开关
- 调试模式开关
- 边界条件检查结果

**文本处理（使用字符串）**：
- 卫星系统标识（'BEIDOU'、'GPS'）
- 文件路径（RINEX文件路径、配置文件路径）
- 错误消息（异常信息、日志消息）
- 数据格式（时间格式字符串、坐标格式字符串）

### 2. 代码质量要求
- **测试覆盖率**：单元测试覆盖率≥95%
- **代码规范**：ESLint检查通过，Prettier格式化
- **文档完整性**：函数注释完整，API文档齐全
- **错误处理**：完善的异常处理机制
- **性能要求**：单次计算<10ms，内存使用<100MB

### 3. 算法精度要求
- **卫星位置计算**：位置精度<10m
- **坐标转换**：转换精度<1m
- **时间转换**：时间精度<1ms
- **信号处理**：信号强度误差<1dB
- **天线增益**：增益计算误差<0.5dB

### 4. 性能要求
- **更新频率**：100ms
- **响应时间**：端到端响应时间<100ms
- **并发处理**：支持至少100个并发连接
- **内存使用**：<100MB
- **CPU使用率**：<30%

## 进度跟踪机制

### 1. 任务状态跟踪
**状态定义**：
- ✅ **已完成**：任务已完成并通过测试
- 🔄 **进行中**：任务正在开发中
- ⏳ **待开始**：任务尚未开始
- ❌ **已阻塞**：任务因问题无法继续
- ⚠️ **需关注**：任务存在风险或问题

### 2. 每日进度更新
**更新内容**：
- 当日完成任务列表
- 遇到的问题和解决方案
- 次日工作计划
- 风险识别和应对措施

### 3. 周度进度报告
**报告内容**：
- 本周完成任务总结
- 里程碑达成情况
- 下周工作计划
- 质量指标统计
- 风险和问题跟踪

### 4. 质量指标跟踪
**指标清单**：
- 代码覆盖率
- 测试通过率
- 代码复杂度
- 性能指标
- 缺陷密度

## 风险管理

### 1. 技术风险
| 风险ID | 风险描述 | 影响程度 | 发生概率 | 缓解措施 | 责任人 |
|--------|----------|----------|----------|----------|--------|
| TECH-001 | 算法精度不满足要求 | 高 | 中 | 制定严格的测试方案 | 技术负责人 |
| TECH-002 | 性能不满足实时要求 | 高 | 中 | 进行性能优化和测试 | 技术负责人 |
| TECH-003 | 数据类型选择不当 | 中 | 中 | 遵循数据类型使用策略 | 开发团队 |

### 2. 进度风险
| 风险ID | 风险描述 | 影响程度 | 发生概率 | 缓解措施 | 责任人 |
|--------|----------|----------|----------|----------|--------|
| SCHED-001 | 开发周期紧张 | 高 | 高 | 优化开发流程，并行开发 | 项目经理 |
| SCHED-002 | TDD开发效率低 | 中 | 中 | 加强TDD培训和经验分享 | 技术负责人 |
| SCHED-003 | 需求变更影响进度 | 中 | 中 | 严格需求变更管理 | 项目经理 |

### 3. 质量风险
| 风险ID | 风险描述 | 影响程度 | 发生概率 | 缓解措施 | 责任人 |
|--------|----------|----------|----------|----------|--------|
| QUAL-001 | 代码质量不达标 | 高 | 低 | 严格的代码审查和测试 | 技术负责人 |
| QUAL-002 | 测试覆盖率不足 | 中 | 中 | 制定测试覆盖率目标 | 测试负责人 |
| QUAL-003 | 文档不完善 | 低 | 中 | 实时更新文档 | 开发团队 |

## 资源需求

### 1. 人力资源
- **项目经理**：1人，负责项目管理和进度跟踪
- **技术负责人**：1人，负责技术决策和质量控制
- **开发工程师**：2-3人，负责算法开发和实现
- **测试工程师**：1人，负责测试用例编写和测试执行
- **前端工程师**：1人，负责前端界面开发

### 2. 开发环境
- **开发工具**：VS Code、Git、Node.js
- **测试工具**：Jest、ESLint、Prettier
- **版本控制**：Git、GitHub
- **文档工具**：Markdown、API文档生成工具

### 3. 测试环境
- **单元测试环境**：Jest测试框架
- **集成测试环境**：完整的后端服务环境
- **性能测试环境**：负载测试工具
- **端到端测试环境**：完整的系统环境

### 4. 测试数据
- **RINEX文件**：北斗和GPS的标准RINEX文件
- **基准数据**：已知精确结果的测试数据
- **边界数据**：极端情况下的测试数据
- **性能数据**：大量数据用于性能测试

## 验收标准

### 1. 功能验收标准
- [ ] 卫星位置计算功能正常，精度<10m
- [ ] 坐标转换功能正常，精度<1m
- [ ] RINEX数据解析功能正常，支持2.x和3.x格式
- [ ] 实时更新功能正常，更新频率100ms
- [ ] 3D可视化功能正常，显示飞机和卫星位置
- [ ] 信号处理功能正常，计算信号强度和载噪比

### 2. 性能验收标准
- [ ] 端到端响应时间<100ms
- [ ] 支持100个并发连接
- [ ] 内存使用<100MB
- [ ] CPU使用率<30%
- [ ] 单次计算时间<10ms

### 3. 质量验收标准
- [ ] 单元测试覆盖率≥95%
- [ ] 集成测试覆盖率≥90%
- [ ] 系统测试覆盖率≥85%
- [ ] 代码检查通过ESLint
- [ ] 代码格式符合Prettier标准
- [ ] 文档完整性和准确性

### 4. 文档验收标准
- [ ] API文档完整
- [ ] 用户手册完整
- [ ] 部署文档完整
- [ ] 测试报告完整
- [ ] 维护文档完整

---

## 文档维护说明

### 更新频率
- **日常更新**：每日更新任务完成状态和进度
- **周度更新**：每周更新里程碑状态和下周计划
- **月度更新**：每月更新质量指标和风险状态

### 更新责任人
- **项目经理**：负责总体进度和里程碑更新
- **技术负责人**：负责技术需求和模块状态更新
- **测试负责人**：负责测试状态和质量指标更新
- **开发团队**：负责具体任务状态更新

### 更新流程
1. **状态收集**：各责任人收集最新状态信息
2. **状态验证**：项目经理验证状态信息的准确性
3. **文档更新**：更新本文档中的相应状态
4. **状态发布**：向团队发布最新的项目状态
5. **问题跟踪**：跟踪和解决发现的问题

---

**备注**：本文档将根据项目进展实时更新，确保所有项目相关方能够及时了解项目的最新状态和进展情况。
